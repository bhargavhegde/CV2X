<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.17"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Commsignia V2X Remote C SDK: examples/security_hsm.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Commsignia V2X Remote C SDK
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_d28a4824dc47e487b107a5db32ef43c4.html">examples</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">security_hsm.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="security__hsm_8c.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160; </div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &lt;stddef.h&gt;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &lt;stdbool.h&gt;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &lt;stdio.h&gt;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &lt;unistd.h&gt;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="api_8h.html">cms_v2x/api.h</a>&gt;</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="security_8h.html">cms_v2x/security.h</a>&gt;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="security__types_8h.html">cms_v2x/security_types.h</a>&gt;</span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160; </div>
<div class="line"><a name="l00024"></a><span class="lineno"><a class="line" href="security__hsm_8c.html#a4a3c8e039d08218b30b9ef94c2d4de7e">   24</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="security__hsm_8c.html#a4a3c8e039d08218b30b9ef94c2d4de7e">print_scalar</a>(<span class="keyword">const</span> <a class="code" href="group__sec__types.html#gaf9783af20eed80529f2f4455e04eccb5">cms_sec_scalar_t</a> scalar)</div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;{</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;    <span class="keywordflow">if</span>(NULL != scalar) {</div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;        <span class="keywordflow">for</span>(uint32_t i = 0UL; i &lt; <span class="keyword">sizeof</span>(<a class="code" href="group__sec__types.html#gaf9783af20eed80529f2f4455e04eccb5">cms_sec_scalar_t</a>); ++i) {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;            printf(<span class="stringliteral">&quot;%02X&quot;</span>, scalar[i]);</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;        }</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;    }</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;}</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno"><a class="line" href="security__hsm_8c.html#ad3e1ea5ef4aafb9b1edaea5a17f2ea7d">   33</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="security__hsm_8c.html#ad3e1ea5ef4aafb9b1edaea5a17f2ea7d">print_public_key</a>(<span class="keyword">const</span> <a class="code" href="structcms__sec__pubkey__t.html">cms_sec_pubkey_t</a>* public_key)</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;{</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;    <span class="keywordflow">if</span>(NULL != public_key) {</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;        printf(<span class="stringliteral">&quot;  Public Key:\n&quot;</span>);</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;        printf(<span class="stringliteral">&quot;  ECC curve type: %d\n&quot;</span>, public_key-&gt;<a class="code" href="structcms__sec__pubkey__t.html#ad4daafc4bbfea2f06948cacb6dc02aa0">curve</a>);</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;        printf(<span class="stringliteral">&quot;  Point compression type: %d\n&quot;</span>, public_key-&gt;<a class="code" href="structcms__sec__pubkey__t.html#a1b7aa7724955e63bba5b35c10a6adef3">type</a>);</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;        printf(<span class="stringliteral">&quot;  X coordinate:\n    &quot;</span>);</div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;        <a class="code" href="security__hsm_8c.html#a4a3c8e039d08218b30b9ef94c2d4de7e">print_scalar</a>(public_key-&gt;<a class="code" href="structcms__sec__pubkey__t.html#ab72dc7af80d499f8dae1210b1aa7e0f8">x</a>);</div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;        printf(<span class="stringliteral">&quot;\n  Y coordinate:\n    &quot;</span>);</div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;        <a class="code" href="security__hsm_8c.html#a4a3c8e039d08218b30b9ef94c2d4de7e">print_scalar</a>(public_key-&gt;<a class="code" href="structcms__sec__pubkey__t.html#a7de6da7c530f2eb20929547f35f7bd24">y</a>);</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;        printf(<span class="stringliteral">&quot;\n\n&quot;</span>);</div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;    }</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;}</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="security__hsm_8c.html#a1cb345f8d5049e347dc8b3906235c7ff">   47</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="security__hsm_8c.html#a1cb345f8d5049e347dc8b3906235c7ff">print_key_info</a>(<span class="keyword">const</span> <a class="code" href="structcms__sec__hsm__key__info__t.html">cms_sec_hsm_key_info_t</a>* key_info)</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">if</span>(NULL != key_info) {</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;        printf(<span class="stringliteral">&quot;  Key info:\n&quot;</span>);</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        printf(<span class="stringliteral">&quot;    ECC curve type of key: %d\n&quot;</span>, key_info-&gt;<a class="code" href="structcms__sec__hsm__key__info__t.html#aaad5fb1708007aa3e4407b5b36f8fb37">curve</a>);</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;        printf(<span class="stringliteral">&quot;    Private key type: %d\n&quot;</span>, key_info-&gt;<a class="code" href="structcms__sec__hsm__key__info__t.html#ac6b7e4259679c62e4832f1bc0853fa46">private_key_type</a>);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;        printf(<span class="stringliteral">&quot;    Public key type: %d\n&quot;</span>, key_info-&gt;<a class="code" href="structcms__sec__hsm__key__info__t.html#a95c4e17b1856206f749ad17919820ec9">public_key_type</a>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;}</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160; </div>
<div class="line"><a name="l00057"></a><span class="lineno"><a class="line" href="security__hsm_8c.html#aee6831288286c26515b006672f40b867">   57</a></span>&#160;<span class="keyword">static</span> <span class="keyword">inline</span> <span class="keywordtype">void</span> <a class="code" href="security__hsm_8c.html#aee6831288286c26515b006672f40b867">print_signature</a>(<a class="code" href="structcms__sec__signature__t.html">cms_sec_signature_t</a>* signature)</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    <span class="keywordflow">if</span>(NULL != signature) {</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        printf(<span class="stringliteral">&quot;  Point compression type: %d\n&quot;</span>, signature-&gt;<a class="code" href="structcms__sec__signature__t.html#accc7ddbbb7144782c02af7ab2d4e5bb6">r_type</a>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        printf(<span class="stringliteral">&quot;  X xoordinate of R point:\n    &quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <a class="code" href="security__hsm_8c.html#a4a3c8e039d08218b30b9ef94c2d4de7e">print_scalar</a>(signature-&gt;<a class="code" href="structcms__sec__signature__t.html#ad38a6e72efb0e27f24737b80a4052e0f">r_x</a>);</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        printf(<span class="stringliteral">&quot;\n  Scalar part of signature:\n    &quot;</span>);</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="security__hsm_8c.html#a4a3c8e039d08218b30b9ef94c2d4de7e">print_scalar</a>(signature-&gt;<a class="code" href="structcms__sec__signature__t.html#a270e0f3f714af38c03eb4e629402d31a">s</a>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        printf(<span class="stringliteral">&quot;\n\n&quot;</span>);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    }</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;}</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160; </div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160; </div>
<div class="line"><a name="l00070"></a><span class="lineno"><a class="line" href="security__hsm_8c.html#ac81a09ae711ded0c749197c40871e037">   70</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="security__hsm_8c.html#ac81a09ae711ded0c749197c40871e037">do_generate_key</a>(<a class="code" href="structcms__session__t.html">cms_session_t</a>* session, uint32_t key_index)</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <span class="keywordtype">bool</span> error = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">/* Generate private key */</span></div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <a class="code" href="structcms__sec__hsm__generate__key__in__t.html">cms_sec_hsm_generate_key_in_t</a> generate_key_in = {</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        .<a class="code" href="structcms__sec__hsm__generate__key__in__t.html#a345444ffb23b1ef57be370d50238bf56">slot_info</a>.<a class="code" href="structcms__sec__hsm__slot__info__t.html#a39aca3f21552d9c44bd27c88148c5cec">slot_index</a> = key_index,</div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        .key_info.curve = <a class="code" href="group__sec__types.html#gga2390cfa81c8026a2fd3d894d02dea1b4a35125064b7fa6fb6ce6a234eb79599df">CMS_SEC_CURVE_NIST_P256</a>,</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        .key_info.private_key_type = <a class="code" href="group__sec__types.html#gga4f9e7f6b84624a0a443b36f4d32cc96daf93c13f97debbfab15864f25c35b43aa">CMS_SEC_PRIVATE_KEY_TYPE_PSEUDO</a>,</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        .key_info.public_key_type = <a class="code" href="group__sec__types.html#gga16457bb5e640fe1101ffc314caa0934aa453e6e42e4e031634f517efcaae517ee">CMS_SEC_PUBLIC_KEY_TYPE_SIGN</a></div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;    };</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <a class="code" href="structcms__sec__hsm__generate__key__result__t.html">cms_sec_hsm_generate_key_result_t</a> generate_key_result = {0};</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="group__sec__types.html#ga21fc5b09124045745d30be7195a19e2b">cms_sec_hsm_result_t</a> res = <a class="code" href="group__sec.html#ga272c6e51aa765189cd4e8eb3ea715160">cms_sec_hsm_generate_key</a>(session, &amp;generate_key_in, &amp;generate_key_result);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160; </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="group__sec__types.html#gga21fc5b09124045745d30be7195a19e2bad265355b581878dc226866308d5376f0">CMS_SEC_HSM_RES_OK</a> != res) {</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        printf(<span class="stringliteral">&quot;Unable to generate new private key\n&quot;</span>);</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160; </div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        printf(<span class="stringliteral">&quot;Generate private key result:\n&quot;</span>);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        printf(<span class="stringliteral">&quot;  HSM slot index: %lu\n&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)generate_key_result.<a class="code" href="structcms__sec__hsm__generate__key__result__t.html#a250050041c728f4d4548f95151b39f75">slot_index</a>);</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;        <a class="code" href="security__hsm_8c.html#ad3e1ea5ef4aafb9b1edaea5a17f2ea7d">print_public_key</a>(&amp;generate_key_result.<a class="code" href="structcms__sec__hsm__generate__key__result__t.html#ad787a45b1b3c9a4435a5d910602ff85e">public_key</a>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160; </div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno"><a class="line" href="security__hsm_8c.html#a250f81df9359ba668a03821f1df58670">   98</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="security__hsm_8c.html#a250f81df9359ba668a03821f1df58670">do_get_pubkey</a>(<a class="code" href="structcms__session__t.html">cms_session_t</a>* session, uint32_t key_index)</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;{</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    <span class="keywordtype">bool</span> error = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="comment">/* Get public key of the generated private key */</span></div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    <a class="code" href="structcms__sec__hsm__get__pubkey__in__t.html">cms_sec_hsm_get_pubkey_in_t</a> get_pubkey_in = {</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        .<a class="code" href="structcms__sec__hsm__get__pubkey__in__t.html#a635a3fb34ace9f9d4dcac34ba670e9e7">slot_index</a> = key_index,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    };</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    <a class="code" href="structcms__sec__hsm__get__pubkey__result__t.html">cms_sec_hsm_get_pubkey_result_t</a> get_pubkey_result = {0};</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    <a class="code" href="group__sec__types.html#ga21fc5b09124045745d30be7195a19e2b">cms_sec_hsm_result_t</a> res = <a class="code" href="group__sec.html#ga9e785fa7a5f649350696fe77b642f56b">cms_sec_hsm_get_pubkey</a>(session, &amp;get_pubkey_in, &amp;get_pubkey_result);</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="group__sec__types.html#gga21fc5b09124045745d30be7195a19e2bad265355b581878dc226866308d5376f0">CMS_SEC_HSM_RES_OK</a> != res) {</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        printf(<span class="stringliteral">&quot;Unable to get public key\n&quot;</span>);</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160; </div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        printf(<span class="stringliteral">&quot;Get public key result:\n&quot;</span>);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <a class="code" href="security__hsm_8c.html#a1cb345f8d5049e347dc8b3906235c7ff">print_key_info</a>(&amp;get_pubkey_result.<a class="code" href="structcms__sec__hsm__get__pubkey__result__t.html#a2d871a7c569c96a0a4f7b6f4fb2fed39">key_info</a>);</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        <a class="code" href="security__hsm_8c.html#ad3e1ea5ef4aafb9b1edaea5a17f2ea7d">print_public_key</a>(&amp;get_pubkey_result.<a class="code" href="structcms__sec__hsm__get__pubkey__result__t.html#ae4b3aed28da6a401f73239aff8774856">public_key</a>);</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    }</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;}</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160; </div>
<div class="line"><a name="l00122"></a><span class="lineno"><a class="line" href="security__hsm_8c.html#a921c29edeb3618089eea5dc3ae2af8bc">  122</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="security__hsm_8c.html#a921c29edeb3618089eea5dc3ae2af8bc">do_sign</a>(<a class="code" href="structcms__session__t.html">cms_session_t</a>* session, uint32_t key_index)</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;{</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="keywordtype">bool</span> error = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    <span class="comment">/* Sign hash with generated private key */</span></div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    <a class="code" href="structcms__sec__hsm__sign__in__t.html">cms_sec_hsm_sign_in_t</a> sign_in = {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        .<a class="code" href="structcms__sec__hsm__sign__in__t.html#a70e5b5f009ce90891c6cd24ff58e596b">slot_index</a> = key_index,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;        .hash.algo = <a class="code" href="group__sec__types.html#ggad4011011a6182357274a970c9a30f412aa6855a70629946c882bd20a0284d9dbd">CMS_SEC_HASH_SHA_256</a>,</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="comment">/* First 16 bytes are padded with zeroes as the curve type is 256 bit long */</span></div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        .hash.value = {</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02,</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02,</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;            0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02,</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;            0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02, 0x02</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        }</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    };</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160; </div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="structcms__sec__hsm__sign__result__t.html">cms_sec_hsm_sign_result_t</a> sign_result = {0};</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <a class="code" href="group__sec__types.html#ga21fc5b09124045745d30be7195a19e2b">cms_sec_hsm_result_t</a> res = <a class="code" href="group__sec.html#ga22359e5f2186a2357b8858249a5ffe01">cms_sec_hsm_sign</a>(session, &amp;sign_in, &amp;sign_result);</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160; </div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="group__sec__types.html#gga21fc5b09124045745d30be7195a19e2bad265355b581878dc226866308d5376f0">CMS_SEC_HSM_RES_OK</a> != res) {</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        printf(<span class="stringliteral">&quot;Unable to sign hash with key #%ul\n&quot;</span>, key_index);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160; </div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        printf(<span class="stringliteral">&quot;Sign hash with private key #%ul result:\n&quot;</span>, key_index);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;        <a class="code" href="security__hsm_8c.html#aee6831288286c26515b006672f40b867">print_signature</a>(&amp;sign_result.<a class="code" href="structcms__sec__hsm__sign__result__t.html#aad47f67c18bc5d7c3f44aafdd011aaa2">signature</a>);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    }</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160; </div>
<div class="line"><a name="l00157"></a><span class="lineno"><a class="line" href="security__hsm_8c.html#a8e5f5e8e5e23f2f02d50fffc0fe0f082">  157</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="security__hsm_8c.html#a8e5f5e8e5e23f2f02d50fffc0fe0f082">do_import_key</a>(<a class="code" href="structcms__session__t.html">cms_session_t</a>* session, uint32_t key_index)</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;{</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">bool</span> error = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160; </div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    <span class="comment">/* Import private key */</span></div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <a class="code" href="structcms__sec__hsm__import__key__in__t.html">cms_sec_hsm_import_key_in_t</a> import_key_in = {</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        .<a class="code" href="structcms__sec__hsm__import__key__in__t.html#a4ae32411fd12a7d2db91e8b2f842a825">slot_info</a>.<a class="code" href="structcms__sec__hsm__slot__info__t.html#a39aca3f21552d9c44bd27c88148c5cec">slot_index</a> = key_index,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        .key_info.curve = <a class="code" href="group__sec__types.html#gga2390cfa81c8026a2fd3d894d02dea1b4a35125064b7fa6fb6ce6a234eb79599df">CMS_SEC_CURVE_NIST_P256</a>,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        .key_info.private_key_type = <a class="code" href="group__sec__types.html#gga4f9e7f6b84624a0a443b36f4d32cc96daa7992eb85b57f624ab32155928d0673b">CMS_SEC_PRIVATE_KEY_TYPE_STANDALONE</a>,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;        .key_info.public_key_type = <a class="code" href="group__sec__types.html#gga16457bb5e640fe1101ffc314caa0934aa453e6e42e4e031634f517efcaae517ee">CMS_SEC_PUBLIC_KEY_TYPE_SIGN</a>,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="comment">/* First 16 bytes are padded with zeroes as the curve type is 256 bit long */</span></div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        .privkey = {</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;            0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;            0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;            0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;            0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;            0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        }</div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    };</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    <a class="code" href="structcms__sec__hsm__generate__key__result__t.html">cms_sec_hsm_import_key_result_t</a> import_key_result = {0};</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    <a class="code" href="group__sec__types.html#ga21fc5b09124045745d30be7195a19e2b">cms_sec_hsm_result_t</a> res = <a class="code" href="group__sec.html#ga204ee6648c37495230fad32559796c2a">cms_sec_hsm_import_key</a>(session, &amp;import_key_in, &amp;import_key_result);</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160; </div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="group__sec__types.html#gga21fc5b09124045745d30be7195a19e2bad265355b581878dc226866308d5376f0">CMS_SEC_HSM_RES_OK</a> != res) {</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        printf(<span class="stringliteral">&quot;Unable to import private key\n&quot;</span>);</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160; </div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        printf(<span class="stringliteral">&quot;Import private key result:\n&quot;</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        printf(<span class="stringliteral">&quot;  HSM slot index: %lu\n&quot;</span>, (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)import_key_result.<a class="code" href="structcms__sec__hsm__generate__key__result__t.html#a250050041c728f4d4548f95151b39f75">slot_index</a>);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <a class="code" href="security__hsm_8c.html#ad3e1ea5ef4aafb9b1edaea5a17f2ea7d">print_public_key</a>(&amp;import_key_result.<a class="code" href="structcms__sec__hsm__generate__key__result__t.html#ad787a45b1b3c9a4435a5d910602ff85e">public_key</a>);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    }</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;}</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160; </div>
<div class="line"><a name="l00195"></a><span class="lineno"><a class="line" href="security__hsm_8c.html#a990806d4f6f9a94da95843c9b19c0e6f">  195</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="security__hsm_8c.html#a990806d4f6f9a94da95843c9b19c0e6f">do_private_multiply_add</a>(<a class="code" href="structcms__session__t.html">cms_session_t</a>* session)</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;{</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="keywordtype">bool</span> error = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <a class="code" href="structcms__sec__hsm__private__multiply__add__in__t.html">cms_sec_hsm_private_multiply_add_in_t</a> priv_mul_add_in = {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        .<a class="code" href="structcms__sec__hsm__private__multiply__add__in__t.html#a76c751b58f8e0b989077c107f618cc3d">source_slot</a>  = 0,</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        .destination_slot = {</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;            .slot_index = <a class="code" href="group__sec__types.html#ga5ea7d5599381be44f4c4a0195b4d850d">CMS_SEC_HSM_SLOT_INDEX_NEXT_FREE</a>,</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;            .slot_range = <a class="code" href="group__sec__types.html#ggafb9abaa2f0c482e7090f02f287965963a9163c7c2df458409dc064a8a2871682a">CMS_SEC_HSM_SLOT_RANGE_VOLATILE</a>,</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        },</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    };</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160; </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <a class="code" href="structcms__sec__hsm__private__multiply__add__result__t.html">cms_sec_hsm_private_multiply_add_result_t</a> priv_mul_add_result = {0};</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <a class="code" href="group__sec__types.html#ga21fc5b09124045745d30be7195a19e2b">cms_sec_hsm_result_t</a> hsm_result = <a class="code" href="group__sec.html#ga0e89554e0324e535abe56ccd96f36e16">cms_sec_hsm_private_multiply_add</a>(session,</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;                                                                       &amp;priv_mul_add_in,</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;                                                                       &amp;priv_mul_add_result);</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160; </div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="group__sec__types.html#gga21fc5b09124045745d30be7195a19e2bad265355b581878dc226866308d5376f0">CMS_SEC_HSM_RES_OK</a> != hsm_result) {</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;Unable to private multiply-add\n&quot;</span>);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        printf(<span class="stringliteral">&quot;Successfully private multiply-add. Slot index: %u\n&quot;</span>,</div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;               priv_mul_add_result.<a class="code" href="structcms__sec__hsm__private__multiply__add__result__t.html#a6bf09c3305195b8b1d15da25e8633218">slot_index</a>);</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    }</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160; </div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;}</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160; </div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160; </div>
<div class="line"><a name="l00225"></a><span class="lineno"><a class="line" href="security__hsm_8c.html#aa695d8c72a4b92b02610b12604bb4bde">  225</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="security__hsm_8c.html#aa695d8c72a4b92b02610b12604bb4bde">do_ecdh</a>(<a class="code" href="structcms__session__t.html">cms_session_t</a>* session)</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;{</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">bool</span> error = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160; </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <a class="code" href="structcms__sec__hsm__ecdh__in__t.html">cms_sec_hsm_ecdh_in_t</a> ecdh_in = {</div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        .<a class="code" href="structcms__sec__hsm__ecdh__in__t.html#a07242388073ba74bc287173274276eae">slot_index</a> = 0,</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        .public_key = {</div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            .curve = <a class="code" href="group__sec__types.html#gga2390cfa81c8026a2fd3d894d02dea1b4a35125064b7fa6fb6ce6a234eb79599df">CMS_SEC_CURVE_NIST_P256</a>,</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;            .type  = <a class="code" href="group__sec__types.html#ggad6368718b9c9c1714c51b79f5e1b4e2ca5e7ce88eeffb248d415cee2cf25fbe7f">CMS_SEC_POINT_COMPRESSED_Y0</a>,</div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            .x = {</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                0x84, 0x7D, 0x8E, 0x79, 0x50, 0xFD, 0xED, 0x5F,</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                0x43, 0x98, 0xA9, 0xDE, 0x6C, 0x95, 0x7B, 0xA5,</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                0xE7, 0xAB, 0x8D, 0xA6, 0xB6, 0x25, 0x4D, 0x98,</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                0xF9, 0xC4, 0x3E, 0xA6, 0x84, 0x57, 0x99, 0xF8,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            },</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        },</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;        .kdf_params = {</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            .type = <a class="code" href="group__sec__types.html#ggafca00b23a6467a4927cf4c16f16b808fae2602c0b9da6c16c5b1aeaa90004979a">CMS_SEC_ECDH_KDF2</a>,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;            .p1 = {</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                .algo = <a class="code" href="group__sec__types.html#ggad4011011a6182357274a970c9a30f412aa6855a70629946c882bd20a0284d9dbd">CMS_SEC_HASH_SHA_256</a>,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                .value = {</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                    0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,</div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                    0xe3, 0xb0, 0xc4, 0x42, 0x98, 0xfc, 0x1c, 0x14,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                    0x9a, 0xfb, 0xf4, 0xc8, 0x99, 0x6f, 0xb9, 0x24,</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    0x27, 0xae, 0x41, 0xe4, 0x64, 0x9b, 0x93, 0x4c,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    0xa4, 0x95, 0x99, 0x1b, 0x78, 0x52, 0xb8, 0x55,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                },</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            }</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        },</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        .key_length = <a class="code" href="security__types_8h.html#ad1ed47710b13f236013b92a43838a937">CMS_SEC_ECDH_KEY_LEN</a>,</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;    };</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160; </div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="structcms__sec__hsm__ecdh__result__t.html">cms_sec_hsm_ecdh_result_t</a> ecdh_result = {0};</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160; </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <a class="code" href="group__sec__types.html#ga21fc5b09124045745d30be7195a19e2b">cms_sec_hsm_result_t</a> hsm_result = <a class="code" href="group__sec.html#gaf33d7f41278051831ff55c6119d53e92">cms_sec_hsm_ecdh</a>(session,</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                                                       &amp;ecdh_in,</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                                       &amp;ecdh_result);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160; </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="group__sec__types.html#gga21fc5b09124045745d30be7195a19e2bad265355b581878dc226866308d5376f0">CMS_SEC_HSM_RES_OK</a> != hsm_result) {</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;Unable to ECDH key derive\n&quot;</span>);</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;        error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;        printf(<span class="stringliteral">&quot;ECDH key derived\n  length: %u\n  key:    &quot;</span>,</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;               ecdh_result.<a class="code" href="structcms__sec__hsm__ecdh__result__t.html#a0855bafe4ce63e711b3854af10081841">derived_key</a>.<a class="code" href="structcms__sec__kdf__derived__key__t.html#a4f2df0fbc7e1fd65d280723d05aba5a4">length</a>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;        <span class="keywordflow">for</span>(uint32_t i = 0; i &lt; ecdh_result.<a class="code" href="structcms__sec__hsm__ecdh__result__t.html#a0855bafe4ce63e711b3854af10081841">derived_key</a>.<a class="code" href="structcms__sec__kdf__derived__key__t.html#a4f2df0fbc7e1fd65d280723d05aba5a4">length</a>; ++i) {</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;            printf(<span class="stringliteral">&quot;%.2X&quot;</span>, ecdh_result.<a class="code" href="structcms__sec__hsm__ecdh__result__t.html#a0855bafe4ce63e711b3854af10081841">derived_key</a>.<a class="code" href="structcms__sec__kdf__derived__key__t.html#afd03658c6fd572ed70fae2f2cd62f37c">key</a>[i]);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        }</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        printf(<span class="stringliteral">&quot;\n&quot;</span>);</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    }</div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160; </div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;}</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160; </div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno"><a class="line" href="security__hsm_8c.html#ad41e40ac80c3ffcafd085ba8b7312e02">  283</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="security__hsm_8c.html#ad41e40ac80c3ffcafd085ba8b7312e02">do_put_slot</a>(<a class="code" href="structcms__session__t.html">cms_session_t</a>* session)</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;{</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;    <span class="keywordtype">bool</span> error = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="structcms__sec__hsm__put__slot__in__t.html">cms_sec_hsm_put_slot_in_t</a> put_slot_in = {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;        .<a class="code" href="structcms__sec__hsm__put__slot__in__t.html#a109767a71a3d38ed8f72420e01ebf03a">slot_index</a> = 42</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    };</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    <a class="code" href="group__sec__types.html#ga21fc5b09124045745d30be7195a19e2b">cms_sec_hsm_result_t</a> hsm_result = <a class="code" href="group__sec.html#ga392233256d45fb7a863b92111d3f0d6b">cms_sec_hsm_put_slot</a>(session,</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                                                           &amp;put_slot_in,</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                                           NULL);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160; </div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="group__sec__types.html#gga21fc5b09124045745d30be7195a19e2bad265355b581878dc226866308d5376f0">CMS_SEC_HSM_RES_OK</a> != hsm_result) {</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        fprintf(stderr,</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="stringliteral">&quot;Unable to put volatile slot with id:%u\n&quot;</span>,</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                put_slot_in.<a class="code" href="structcms__sec__hsm__put__slot__in__t.html#a109767a71a3d38ed8f72420e01ebf03a">slot_index</a>);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;        fprintf(stderr,</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <span class="stringliteral">&quot;Successfully put volatile slot\n&quot;</span>);</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;    }</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160; </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;}</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160; </div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="security__hsm_8c.html#a0fa168ba8c24238b6494caeb98738bdb">  309</a></span>&#160;<span class="keyword">static</span> <span class="keywordtype">bool</span> <a class="code" href="security__hsm_8c.html#a0fa168ba8c24238b6494caeb98738bdb">do_is_hw_hsm</a>(<a class="code" href="structcms__session__t.html">cms_session_t</a>* session)</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;{</div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordtype">bool</span> error = <span class="keyword">false</span>;</div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160; </div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <a class="code" href="structcms__sec__hsm__is__hw__result__t.html">cms_sec_hsm_is_hw_result_t</a> is_hw_result = {0};</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="group__sec__types.html#ga21fc5b09124045745d30be7195a19e2b">cms_sec_hsm_result_t</a> hsm_result = <a class="code" href="group__sec.html#gaf006a7a93bfb47aff869d10bdb192113">cms_sec_hsm_is_hw</a>(session,</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                                                        NULL,</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                                                        &amp;is_hw_result);</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160; </div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="group__sec__types.html#gga21fc5b09124045745d30be7195a19e2bad265355b581878dc226866308d5376f0">CMS_SEC_HSM_RES_OK</a> != hsm_result) {</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        fprintf(stderr,</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                <span class="stringliteral">&quot;Unable to read hsm type\n&quot;</span>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;        error = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        fprintf(stderr,</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="stringliteral">&quot;Successfully get hsm type: %s\n&quot;</span>,</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                (is_hw_result.<a class="code" href="structcms__sec__hsm__is__hw__result__t.html#a4fc39e135d2ba7f33491ee077cf8203d">hsm_is_hw</a> == <span class="keyword">true</span>) ? <span class="stringliteral">&quot;HW&quot;</span> : <span class="stringliteral">&quot;SW&quot;</span>);</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160; </div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">return</span> error;</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;}</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160; </div>
<div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="security__hsm_8c.html#a0ddf1224851353fc92bfbff6f499fa97">  332</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="security__hsm_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>* argv[])</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;{</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="keywordflow">if</span>(argc &lt; 3) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        fprintf(stderr, <span class="stringliteral">&quot;Usage: %s &lt;Software stack IP address&gt; &quot;</span></div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                <span class="stringliteral">&quot;&lt;HSM slot index for key generation&gt; &quot;</span></div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                <span class="stringliteral">&quot;[HSM slot index for key import]\n&quot;</span>, argv[0]);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">return</span> 1;</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    }</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">char</span>* host = argv[1];</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    uint32_t generate_key_index = strtoul(argv[2], NULL, 0);</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    uint32_t import_key_index = generate_key_index;</div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="keywordflow">if</span>(argc &gt; 3) {</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;        import_key_index = strtoul(argv[3], NULL, 0);</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    }</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160; </div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">/* You can enable verbose logging with uncommenting the next lines */</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="comment">/* cms_api_init(); */</span></div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <span class="comment">/* cms_api_set_logging(CMS_API_LOG_INFO); */</span></div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    <span class="comment">/* Create a session */</span></div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <a class="code" href="structcms__session__t.html">cms_session_t</a> session = <a class="code" href="group__api__ctrl.html#ga473c5afaa06a708867cc40bc4cd4d04f">cms_get_session</a>();</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    <span class="comment">/* Connect to the host */</span></div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;    <span class="keywordtype">bool</span> error = <a class="code" href="group__api__ctrl.html#ga85a9c0702615ba256d96d9800d224af1">cms_api_connect_easy</a>(&amp;session, host);</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    <span class="comment">/* Generate private key */</span></div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    error = error || <a class="code" href="security__hsm_8c.html#ac81a09ae711ded0c749197c40871e037">do_generate_key</a>(&amp;session, generate_key_index);</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="comment">/* Get public key of the generated private key */</span></div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    error = error || <a class="code" href="security__hsm_8c.html#a250f81df9359ba668a03821f1df58670">do_get_pubkey</a>(&amp;session, generate_key_index);</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    <span class="comment">/* Sign hash with generated private key */</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    error = error || <a class="code" href="security__hsm_8c.html#a921c29edeb3618089eea5dc3ae2af8bc">do_sign</a>(&amp;session, generate_key_index);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160; </div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    <span class="comment">/* Import private key */</span></div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    error = error || <a class="code" href="security__hsm_8c.html#a8e5f5e8e5e23f2f02d50fffc0fe0f082">do_import_key</a>(&amp;session, import_key_index);</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="comment">/* Sign hash with imported private key */</span></div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    error = error || <a class="code" href="security__hsm_8c.html#a921c29edeb3618089eea5dc3ae2af8bc">do_sign</a>(&amp;session, import_key_index);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160; </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    <span class="comment">/* Private multiply-add */</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    error = error || <a class="code" href="security__hsm_8c.html#a990806d4f6f9a94da95843c9b19c0e6f">do_private_multiply_add</a>(&amp;session);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    <span class="comment">/* ECDH key derivation */</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    error = error || <a class="code" href="security__hsm_8c.html#aa695d8c72a4b92b02610b12604bb4bde">do_ecdh</a>(&amp;session);</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="comment">/* Put volatile slot */</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    error = error || <a class="code" href="security__hsm_8c.html#ad41e40ac80c3ffcafd085ba8b7312e02">do_put_slot</a>(&amp;session);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="comment">/* Check HSM type */</span></div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    error = error || <a class="code" href="security__hsm_8c.html#a0fa168ba8c24238b6494caeb98738bdb">do_is_hw_hsm</a>(&amp;session);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="comment">/* Close connection and cleanup */</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    <a class="code" href="group__api__ctrl.html#ga7583cc44bb9957bb886cf232eba8ca4a">cms_api_disconnect</a>(&amp;session);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <a class="code" href="group__api__ctrl.html#gaade3e7c6b58d004beb768f05542526ac">cms_api_clean</a>();</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160; </div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">int</span>)error;</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;}</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="astructcms__sec__hsm__sign__result__t_html_aad47f67c18bc5d7c3f44aafdd011aaa2"><div class="ttname"><a href="structcms__sec__hsm__sign__result__t.html#aad47f67c18bc5d7c3f44aafdd011aaa2">cms_sec_hsm_sign_result_t::signature</a></div><div class="ttdeci">cms_sec_signature_t signature</div><div class="ttdoc">Signature.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00097">security.h:97</a></div></div>
<div class="ttc" id="asecurity__types_8h_html_ad1ed47710b13f236013b92a43838a937"><div class="ttname"><a href="security__types_8h.html#ad1ed47710b13f236013b92a43838a937">CMS_SEC_ECDH_KEY_LEN</a></div><div class="ttdeci">#define CMS_SEC_ECDH_KEY_LEN</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l01046">security_types.h:1046</a></div></div>
<div class="ttc" id="agroup__api__ctrl_html_gaade3e7c6b58d004beb768f05542526ac"><div class="ttname"><a href="group__api__ctrl.html#gaade3e7c6b58d004beb768f05542526ac">cms_api_clean</a></div><div class="ttdeci">void cms_api_clean(void)</div><div class="ttdoc">Cleanup V2X remote API.</div></div>
<div class="ttc" id="astructcms__sec__pubkey__t_html_ad4daafc4bbfea2f06948cacb6dc02aa0"><div class="ttname"><a href="structcms__sec__pubkey__t.html#ad4daafc4bbfea2f06948cacb6dc02aa0">cms_sec_pubkey_t::curve</a></div><div class="ttdeci">cms_sec_curve_t curve</div><div class="ttdoc">Elliptic Curve type.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00403">security_types.h:403</a></div></div>
<div class="ttc" id="astructcms__sec__signature__t_html_a270e0f3f714af38c03eb4e629402d31a"><div class="ttname"><a href="structcms__sec__signature__t.html#a270e0f3f714af38c03eb4e629402d31a">cms_sec_signature_t::s</a></div><div class="ttdeci">cms_sec_scalar_t s</div><div class="ttdoc">Scalar part of signature.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00394">security_types.h:394</a></div></div>
<div class="ttc" id="astructcms__sec__pubkey__t_html"><div class="ttname"><a href="structcms__sec__pubkey__t.html">cms_sec_pubkey_t</a></div><div class="ttdoc">Elliptic Curve point.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00402">security_types.h:402</a></div></div>
<div class="ttc" id="agroup__sec__types_html_ga5ea7d5599381be44f4c4a0195b4d850d"><div class="ttname"><a href="group__sec__types.html#ga5ea7d5599381be44f4c4a0195b4d850d">CMS_SEC_HSM_SLOT_INDEX_NEXT_FREE</a></div><div class="ttdeci">#define CMS_SEC_HSM_SLOT_INDEX_NEXT_FREE</div><div class="ttdoc">HSM slot index value: use next free.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00868">security_types.h:868</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__private__multiply__add__in__t_html"><div class="ttname"><a href="structcms__sec__hsm__private__multiply__add__in__t.html">cms_sec_hsm_private_multiply_add_in_t</a></div><div class="ttdoc">Information on private multiply add via HSM.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00104">security.h:104</a></div></div>
<div class="ttc" id="asecurity__hsm_8c_html_a250f81df9359ba668a03821f1df58670"><div class="ttname"><a href="security__hsm_8c.html#a250f81df9359ba668a03821f1df58670">do_get_pubkey</a></div><div class="ttdeci">static bool do_get_pubkey(cms_session_t *session, uint32_t key_index)</div><div class="ttdef"><b>Definition:</b> <a href="security__hsm_8c_source.html#l00098">security_hsm.c:98</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__ecdh__result__t_html_a0855bafe4ce63e711b3854af10081841"><div class="ttname"><a href="structcms__sec__hsm__ecdh__result__t.html#a0855bafe4ce63e711b3854af10081841">cms_sec_hsm_ecdh_result_t::derived_key</a></div><div class="ttdeci">cms_sec_kdf_derived_key_t derived_key</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00135">security.h:135</a></div></div>
<div class="ttc" id="asecurity__hsm_8c_html_a4a3c8e039d08218b30b9ef94c2d4de7e"><div class="ttname"><a href="security__hsm_8c.html#a4a3c8e039d08218b30b9ef94c2d4de7e">print_scalar</a></div><div class="ttdeci">static void print_scalar(const cms_sec_scalar_t scalar)</div><div class="ttdef"><b>Definition:</b> <a href="security__hsm_8c_source.html#l00024">security_hsm.c:24</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__put__slot__in__t_html"><div class="ttname"><a href="structcms__sec__hsm__put__slot__in__t.html">cms_sec_hsm_put_slot_in_t</a></div><div class="ttdoc">Information on put slot to HSM.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00153">security.h:153</a></div></div>
<div class="ttc" id="astructcms__sec__kdf__derived__key__t_html_a4f2df0fbc7e1fd65d280723d05aba5a4"><div class="ttname"><a href="structcms__sec__kdf__derived__key__t.html#a4f2df0fbc7e1fd65d280723d05aba5a4">cms_sec_kdf_derived_key_t::length</a></div><div class="ttdeci">uint32_t length</div><div class="ttdoc">length of the derived key</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l01070">security_types.h:1070</a></div></div>
<div class="ttc" id="asecurity__hsm_8c_html_a0fa168ba8c24238b6494caeb98738bdb"><div class="ttname"><a href="security__hsm_8c.html#a0fa168ba8c24238b6494caeb98738bdb">do_is_hw_hsm</a></div><div class="ttdeci">static bool do_is_hw_hsm(cms_session_t *session)</div><div class="ttdef"><b>Definition:</b> <a href="security__hsm_8c_source.html#l00309">security_hsm.c:309</a></div></div>
<div class="ttc" id="asecurity__hsm_8c_html_a8e5f5e8e5e23f2f02d50fffc0fe0f082"><div class="ttname"><a href="security__hsm_8c.html#a8e5f5e8e5e23f2f02d50fffc0fe0f082">do_import_key</a></div><div class="ttdeci">static bool do_import_key(cms_session_t *session, uint32_t key_index)</div><div class="ttdef"><b>Definition:</b> <a href="security__hsm_8c_source.html#l00157">security_hsm.c:157</a></div></div>
<div class="ttc" id="asecurity_8h_html"><div class="ttname"><a href="security_8h.html">security.h</a></div><div class="ttdoc">Security data types.</div></div>
<div class="ttc" id="agroup__sec__types_html_ggad6368718b9c9c1714c51b79f5e1b4e2ca5e7ce88eeffb248d415cee2cf25fbe7f"><div class="ttname"><a href="group__sec__types.html#ggad6368718b9c9c1714c51b79f5e1b4e2ca5e7ce88eeffb248d415cee2cf25fbe7f">CMS_SEC_POINT_COMPRESSED_Y0</a></div><div class="ttdeci">@ CMS_SEC_POINT_COMPRESSED_Y0</div><div class="ttdoc">Y coordinate LSB is 0.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00349">security_types.h:349</a></div></div>
<div class="ttc" id="agroup__sec_html_ga0e89554e0324e535abe56ccd96f36e16"><div class="ttname"><a href="group__sec.html#ga0e89554e0324e535abe56ccd96f36e16">cms_sec_hsm_private_multiply_add</a></div><div class="ttdeci">cms_sec_hsm_result_t cms_sec_hsm_private_multiply_add(const cms_session_t *session, const cms_sec_hsm_private_multiply_add_in_t *private_multiply_add_in, cms_sec_hsm_private_multiply_add_result_t *private_multiply_add_result)</div><div class="ttdoc">Function to generate a HSM key into a HSM slot with the multiply-add operation.</div></div>
<div class="ttc" id="agroup__sec__types_html_gga4f9e7f6b84624a0a443b36f4d32cc96daa7992eb85b57f624ab32155928d0673b"><div class="ttname"><a href="group__sec__types.html#gga4f9e7f6b84624a0a443b36f4d32cc96daa7992eb85b57f624ab32155928d0673b">CMS_SEC_PRIVATE_KEY_TYPE_STANDALONE</a></div><div class="ttdeci">@ CMS_SEC_PRIVATE_KEY_TYPE_STANDALONE</div><div class="ttdoc">Imported.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00901">security_types.h:901</a></div></div>
<div class="ttc" id="agroup__api__ctrl_html_ga473c5afaa06a708867cc40bc4cd4d04f"><div class="ttname"><a href="group__api__ctrl.html#ga473c5afaa06a708867cc40bc4cd4d04f">cms_get_session</a></div><div class="ttdeci">cms_session_t cms_get_session(void)</div><div class="ttdoc">Create a session for using the V2X API.</div></div>
<div class="ttc" id="astructcms__sec__hsm__generate__key__result__t_html_ad787a45b1b3c9a4435a5d910602ff85e"><div class="ttname"><a href="structcms__sec__hsm__generate__key__result__t.html#ad787a45b1b3c9a4435a5d910602ff85e">cms_sec_hsm_generate_key_result_t::public_key</a></div><div class="ttdeci">cms_sec_pubkey_t public_key</div><div class="ttdoc">Public key of the generated private key.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00047">security.h:47</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__slot__info__t_html_a39aca3f21552d9c44bd27c88148c5cec"><div class="ttname"><a href="structcms__sec__hsm__slot__info__t.html#a39aca3f21552d9c44bd27c88148c5cec">cms_sec_hsm_slot_info_t::slot_index</a></div><div class="ttdeci">cms_sec_hsm_slot_index_t slot_index</div><div class="ttdoc">HSM slot index.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00893">security_types.h:893</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__key__info__t_html_ac6b7e4259679c62e4832f1bc0853fa46"><div class="ttname"><a href="structcms__sec__hsm__key__info__t.html#ac6b7e4259679c62e4832f1bc0853fa46">cms_sec_hsm_key_info_t::private_key_type</a></div><div class="ttdeci">cms_sec_private_key_type_t private_key_type</div><div class="ttdoc">Private key type.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00955">security_types.h:955</a></div></div>
<div class="ttc" id="agroup__sec_html_ga22359e5f2186a2357b8858249a5ffe01"><div class="ttname"><a href="group__sec.html#ga22359e5f2186a2357b8858249a5ffe01">cms_sec_hsm_sign</a></div><div class="ttdeci">cms_sec_hsm_result_t cms_sec_hsm_sign(const cms_session_t *session, const cms_sec_hsm_sign_in_t *sign_in, cms_sec_hsm_sign_result_t *sign_result)</div><div class="ttdoc">Function to sign a hash with a private key in a specific HSM slot.</div></div>
<div class="ttc" id="agroup__sec__types_html_gga2390cfa81c8026a2fd3d894d02dea1b4a35125064b7fa6fb6ce6a234eb79599df"><div class="ttname"><a href="group__sec__types.html#gga2390cfa81c8026a2fd3d894d02dea1b4a35125064b7fa6fb6ce6a234eb79599df">CMS_SEC_CURVE_NIST_P256</a></div><div class="ttdeci">@ CMS_SEC_CURVE_NIST_P256</div><div class="ttdoc">NISTp256 ECC curve.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00078">security_types.h:78</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__import__key__in__t_html_a4ae32411fd12a7d2db91e8b2f842a825"><div class="ttname"><a href="structcms__sec__hsm__import__key__in__t.html#a4ae32411fd12a7d2db91e8b2f842a825">cms_sec_hsm_import_key_in_t::slot_info</a></div><div class="ttdeci">cms_sec_hsm_slot_info_t slot_info</div><div class="ttdoc">HSM slot info.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00055">security.h:55</a></div></div>
<div class="ttc" id="astructcms__sec__pubkey__t_html_ab72dc7af80d499f8dae1210b1aa7e0f8"><div class="ttname"><a href="structcms__sec__pubkey__t.html#ab72dc7af80d499f8dae1210b1aa7e0f8">cms_sec_pubkey_t::x</a></div><div class="ttdeci">cms_sec_scalar_t x</div><div class="ttdoc">X coordinate of the point.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00405">security_types.h:405</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__get__pubkey__result__t_html"><div class="ttname"><a href="structcms__sec__hsm__get__pubkey__result__t.html">cms_sec_hsm_get_pubkey_result_t</a></div><div class="ttdoc">HSM get public key result.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00078">security.h:78</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__private__multiply__add__result__t_html_a6bf09c3305195b8b1d15da25e8633218"><div class="ttname"><a href="structcms__sec__hsm__private__multiply__add__result__t.html#a6bf09c3305195b8b1d15da25e8633218">cms_sec_hsm_private_multiply_add_result_t::slot_index</a></div><div class="ttdeci">cms_sec_hsm_slot_index_t slot_index</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00116">security.h:116</a></div></div>
<div class="ttc" id="asecurity__types_8h_html"><div class="ttname"><a href="security__types_8h.html">security_types.h</a></div><div class="ttdoc">Security data types.</div></div>
<div class="ttc" id="astructcms__sec__hsm__key__info__t_html_a95c4e17b1856206f749ad17919820ec9"><div class="ttname"><a href="structcms__sec__hsm__key__info__t.html#a95c4e17b1856206f749ad17919820ec9">cms_sec_hsm_key_info_t::public_key_type</a></div><div class="ttdeci">cms_sec_public_key_type_t public_key_type</div><div class="ttdoc">Public key type.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00956">security_types.h:956</a></div></div>
<div class="ttc" id="astructcms__session__t_html"><div class="ttname"><a href="structcms__session__t.html">cms_session_t</a></div><div class="ttdoc">Client session.</div><div class="ttdef"><b>Definition:</b> <a href="session_8h_source.html#l00034">session.h:34</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__get__pubkey__result__t_html_a2d871a7c569c96a0a4f7b6f4fb2fed39"><div class="ttname"><a href="structcms__sec__hsm__get__pubkey__result__t.html#a2d871a7c569c96a0a4f7b6f4fb2fed39">cms_sec_hsm_get_pubkey_result_t::key_info</a></div><div class="ttdeci">cms_sec_hsm_key_info_t key_info</div><div class="ttdoc">HSM key information.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00080">security.h:80</a></div></div>
<div class="ttc" id="asecurity__hsm_8c_html_a921c29edeb3618089eea5dc3ae2af8bc"><div class="ttname"><a href="security__hsm_8c.html#a921c29edeb3618089eea5dc3ae2af8bc">do_sign</a></div><div class="ttdeci">static bool do_sign(cms_session_t *session, uint32_t key_index)</div><div class="ttdef"><b>Definition:</b> <a href="security__hsm_8c_source.html#l00122">security_hsm.c:122</a></div></div>
<div class="ttc" id="agroup__sec__types_html_ggad4011011a6182357274a970c9a30f412aa6855a70629946c882bd20a0284d9dbd"><div class="ttname"><a href="group__sec__types.html#ggad4011011a6182357274a970c9a30f412aa6855a70629946c882bd20a0284d9dbd">CMS_SEC_HASH_SHA_256</a></div><div class="ttdeci">@ CMS_SEC_HASH_SHA_256</div><div class="ttdoc">SHA2-256.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00237">security_types.h:237</a></div></div>
<div class="ttc" id="asecurity__hsm_8c_html_a990806d4f6f9a94da95843c9b19c0e6f"><div class="ttname"><a href="security__hsm_8c.html#a990806d4f6f9a94da95843c9b19c0e6f">do_private_multiply_add</a></div><div class="ttdeci">static bool do_private_multiply_add(cms_session_t *session)</div><div class="ttdef"><b>Definition:</b> <a href="security__hsm_8c_source.html#l00195">security_hsm.c:195</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__private__multiply__add__result__t_html"><div class="ttname"><a href="structcms__sec__hsm__private__multiply__add__result__t.html">cms_sec_hsm_private_multiply_add_result_t</a></div><div class="ttdoc">HSM private multiply add result.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00115">security.h:115</a></div></div>
<div class="ttc" id="agroup__sec__types_html_ga21fc5b09124045745d30be7195a19e2b"><div class="ttname"><a href="group__sec__types.html#ga21fc5b09124045745d30be7195a19e2b">cms_sec_hsm_result_t</a></div><div class="ttdeci">cms_sec_hsm_result_t</div><div class="ttdoc">HSM request's result code.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00963">security_types.h:963</a></div></div>
<div class="ttc" id="agroup__sec__types_html_ggafb9abaa2f0c482e7090f02f287965963a9163c7c2df458409dc064a8a2871682a"><div class="ttname"><a href="group__sec__types.html#ggafb9abaa2f0c482e7090f02f287965963a9163c7c2df458409dc064a8a2871682a">CMS_SEC_HSM_SLOT_RANGE_VOLATILE</a></div><div class="ttdeci">@ CMS_SEC_HSM_SLOT_RANGE_VOLATILE</div><div class="ttdoc">Volatile range</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00882">security_types.h:882</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__sign__result__t_html"><div class="ttname"><a href="structcms__sec__hsm__sign__result__t.html">cms_sec_hsm_sign_result_t</a></div><div class="ttdoc">HSM sign result.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00096">security.h:96</a></div></div>
<div class="ttc" id="astructcms__sec__signature__t_html_accc7ddbbb7144782c02af7ab2d4e5bb6"><div class="ttname"><a href="structcms__sec__signature__t.html#accc7ddbbb7144782c02af7ab2d4e5bb6">cms_sec_signature_t::r_type</a></div><div class="ttdeci">cms_sec_point_type_t r_type</div><div class="ttdoc">R point compression type, cannot be uncompressed.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00392">security_types.h:392</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__get__pubkey__in__t_html"><div class="ttname"><a href="structcms__sec__hsm__get__pubkey__in__t.html">cms_sec_hsm_get_pubkey_in_t</a></div><div class="ttdoc">Information on getting a public key from HSM.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00070">security.h:70</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__ecdh__in__t_html"><div class="ttname"><a href="structcms__sec__hsm__ecdh__in__t.html">cms_sec_hsm_ecdh_in_t</a></div><div class="ttdoc">Information on derive ECDH key via HSM.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00123">security.h:123</a></div></div>
<div class="ttc" id="agroup__sec__types_html_gga21fc5b09124045745d30be7195a19e2bad265355b581878dc226866308d5376f0"><div class="ttname"><a href="group__sec__types.html#gga21fc5b09124045745d30be7195a19e2bad265355b581878dc226866308d5376f0">CMS_SEC_HSM_RES_OK</a></div><div class="ttdeci">@ CMS_SEC_HSM_RES_OK</div><div class="ttdoc">Success.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00964">security_types.h:964</a></div></div>
<div class="ttc" id="agroup__sec_html_ga392233256d45fb7a863b92111d3f0d6b"><div class="ttname"><a href="group__sec.html#ga392233256d45fb7a863b92111d3f0d6b">cms_sec_hsm_put_slot</a></div><div class="ttdeci">cms_sec_hsm_result_t cms_sec_hsm_put_slot(const cms_session_t *session, const cms_sec_hsm_put_slot_in_t *put_slot_in, const void *unused_out)</div><div class="ttdoc">Function to mark a specific HSM slot as unused.</div></div>
<div class="ttc" id="agroup__api__ctrl_html_ga7583cc44bb9957bb886cf232eba8ca4a"><div class="ttname"><a href="group__api__ctrl.html#ga7583cc44bb9957bb886cf232eba8ca4a">cms_api_disconnect</a></div><div class="ttdeci">bool cms_api_disconnect(const cms_session_t *session)</div><div class="ttdoc">Disconnect V2X remote API for a session.</div></div>
<div class="ttc" id="asecurity__hsm_8c_html_ad3e1ea5ef4aafb9b1edaea5a17f2ea7d"><div class="ttname"><a href="security__hsm_8c.html#ad3e1ea5ef4aafb9b1edaea5a17f2ea7d">print_public_key</a></div><div class="ttdeci">static void print_public_key(const cms_sec_pubkey_t *public_key)</div><div class="ttdef"><b>Definition:</b> <a href="security__hsm_8c_source.html#l00033">security_hsm.c:33</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__generate__key__in__t_html_a345444ffb23b1ef57be370d50238bf56"><div class="ttname"><a href="structcms__sec__hsm__generate__key__in__t.html#a345444ffb23b1ef57be370d50238bf56">cms_sec_hsm_generate_key_in_t::slot_info</a></div><div class="ttdeci">cms_sec_hsm_slot_info_t slot_info</div><div class="ttdoc">HSM slot information.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00037">security.h:37</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__get__pubkey__result__t_html_ae4b3aed28da6a401f73239aff8774856"><div class="ttname"><a href="structcms__sec__hsm__get__pubkey__result__t.html#ae4b3aed28da6a401f73239aff8774856">cms_sec_hsm_get_pubkey_result_t::public_key</a></div><div class="ttdeci">cms_sec_pubkey_t public_key</div><div class="ttdoc">Requested public key.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00079">security.h:79</a></div></div>
<div class="ttc" id="agroup__sec_html_ga9e785fa7a5f649350696fe77b642f56b"><div class="ttname"><a href="group__sec.html#ga9e785fa7a5f649350696fe77b642f56b">cms_sec_hsm_get_pubkey</a></div><div class="ttdeci">cms_sec_hsm_result_t cms_sec_hsm_get_pubkey(const cms_session_t *session, const cms_sec_hsm_get_pubkey_in_t *get_pubkey_in, cms_sec_hsm_get_pubkey_result_t *get_pubkey_result)</div><div class="ttdoc">Function to get the public key and type for a HSM slot.</div></div>
<div class="ttc" id="astructcms__sec__hsm__generate__key__result__t_html_a250050041c728f4d4548f95151b39f75"><div class="ttname"><a href="structcms__sec__hsm__generate__key__result__t.html#a250050041c728f4d4548f95151b39f75">cms_sec_hsm_generate_key_result_t::slot_index</a></div><div class="ttdeci">cms_sec_hsm_slot_index_t slot_index</div><div class="ttdoc">HSM slot index where the key was generated.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00046">security.h:46</a></div></div>
<div class="ttc" id="agroup__sec_html_gaf33d7f41278051831ff55c6119d53e92"><div class="ttname"><a href="group__sec.html#gaf33d7f41278051831ff55c6119d53e92">cms_sec_hsm_ecdh</a></div><div class="ttdeci">cms_sec_hsm_result_t cms_sec_hsm_ecdh(const cms_session_t *session, const cms_sec_hsm_ecdh_in_t *ecdh_in, cms_sec_hsm_ecdh_result_t *ecdh_result)</div><div class="ttdoc">Function to derive ECDH key.</div></div>
<div class="ttc" id="astructcms__sec__hsm__is__hw__result__t_html"><div class="ttname"><a href="structcms__sec__hsm__is__hw__result__t.html">cms_sec_hsm_is_hw_result_t</a></div><div class="ttdoc">HSM is implemented in hw result.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00161">security.h:161</a></div></div>
<div class="ttc" id="agroup__sec_html_ga272c6e51aa765189cd4e8eb3ea715160"><div class="ttname"><a href="group__sec.html#ga272c6e51aa765189cd4e8eb3ea715160">cms_sec_hsm_generate_key</a></div><div class="ttdeci">cms_sec_hsm_result_t cms_sec_hsm_generate_key(const cms_session_t *session, const cms_sec_hsm_generate_key_in_t *generate_key_in, cms_sec_hsm_generate_key_result_t *generate_key_result)</div><div class="ttdoc">Function to generate private key into a specific HSM slot.</div></div>
<div class="ttc" id="astructcms__sec__hsm__key__info__t_html"><div class="ttname"><a href="structcms__sec__hsm__key__info__t.html">cms_sec_hsm_key_info_t</a></div><div class="ttdoc">HSM key information.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00953">security_types.h:953</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__is__hw__result__t_html_a4fc39e135d2ba7f33491ee077cf8203d"><div class="ttname"><a href="structcms__sec__hsm__is__hw__result__t.html#a4fc39e135d2ba7f33491ee077cf8203d">cms_sec_hsm_is_hw_result_t::hsm_is_hw</a></div><div class="ttdeci">bool hsm_is_hw</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00162">security.h:162</a></div></div>
<div class="ttc" id="asecurity__hsm_8c_html_aee6831288286c26515b006672f40b867"><div class="ttname"><a href="security__hsm_8c.html#aee6831288286c26515b006672f40b867">print_signature</a></div><div class="ttdeci">static void print_signature(cms_sec_signature_t *signature)</div><div class="ttdef"><b>Definition:</b> <a href="security__hsm_8c_source.html#l00057">security_hsm.c:57</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__sign__in__t_html_a70e5b5f009ce90891c6cd24ff58e596b"><div class="ttname"><a href="structcms__sec__hsm__sign__in__t.html#a70e5b5f009ce90891c6cd24ff58e596b">cms_sec_hsm_sign_in_t::slot_index</a></div><div class="ttdeci">cms_sec_hsm_slot_index_t slot_index</div><div class="ttdoc">HSM slot index.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00088">security.h:88</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__ecdh__result__t_html"><div class="ttname"><a href="structcms__sec__hsm__ecdh__result__t.html">cms_sec_hsm_ecdh_result_t</a></div><div class="ttdoc">HSM derive ECDH key result.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00134">security.h:134</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__generate__key__result__t_html"><div class="ttname"><a href="structcms__sec__hsm__generate__key__result__t.html">cms_sec_hsm_generate_key_result_t</a></div><div class="ttdoc">HSM generate private key result.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00045">security.h:45</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__key__info__t_html_aaad5fb1708007aa3e4407b5b36f8fb37"><div class="ttname"><a href="structcms__sec__hsm__key__info__t.html#aaad5fb1708007aa3e4407b5b36f8fb37">cms_sec_hsm_key_info_t::curve</a></div><div class="ttdeci">cms_sec_curve_t curve</div><div class="ttdoc">Elliptic Curve type.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00954">security_types.h:954</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__ecdh__in__t_html_a07242388073ba74bc287173274276eae"><div class="ttname"><a href="structcms__sec__hsm__ecdh__in__t.html#a07242388073ba74bc287173274276eae">cms_sec_hsm_ecdh_in_t::slot_index</a></div><div class="ttdeci">cms_sec_hsm_slot_index_t slot_index</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00124">security.h:124</a></div></div>
<div class="ttc" id="agroup__sec_html_gaf006a7a93bfb47aff869d10bdb192113"><div class="ttname"><a href="group__sec.html#gaf006a7a93bfb47aff869d10bdb192113">cms_sec_hsm_is_hw</a></div><div class="ttdeci">cms_sec_hsm_result_t cms_sec_hsm_is_hw(const cms_session_t *session, const void *unused_in, cms_sec_hsm_is_hw_result_t *is_hw_result)</div><div class="ttdoc">Function to check if HSM is implemented in HW.</div></div>
<div class="ttc" id="astructcms__sec__hsm__sign__in__t_html"><div class="ttname"><a href="structcms__sec__hsm__sign__in__t.html">cms_sec_hsm_sign_in_t</a></div><div class="ttdoc">Information on signing a hash via HSM.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00087">security.h:87</a></div></div>
<div class="ttc" id="agroup__sec_html_ga204ee6648c37495230fad32559796c2a"><div class="ttname"><a href="group__sec.html#ga204ee6648c37495230fad32559796c2a">cms_sec_hsm_import_key</a></div><div class="ttdeci">cms_sec_hsm_result_t cms_sec_hsm_import_key(const cms_session_t *session, const cms_sec_hsm_import_key_in_t *import_key_in, cms_sec_hsm_import_key_result_t *import_key_result)</div><div class="ttdoc">Function to import private key into a specific HSM slot.</div></div>
<div class="ttc" id="asecurity__hsm_8c_html_a1cb345f8d5049e347dc8b3906235c7ff"><div class="ttname"><a href="security__hsm_8c.html#a1cb345f8d5049e347dc8b3906235c7ff">print_key_info</a></div><div class="ttdeci">static void print_key_info(const cms_sec_hsm_key_info_t *key_info)</div><div class="ttdef"><b>Definition:</b> <a href="security__hsm_8c_source.html#l00047">security_hsm.c:47</a></div></div>
<div class="ttc" id="asecurity__hsm_8c_html_aa695d8c72a4b92b02610b12604bb4bde"><div class="ttname"><a href="security__hsm_8c.html#aa695d8c72a4b92b02610b12604bb4bde">do_ecdh</a></div><div class="ttdeci">static bool do_ecdh(cms_session_t *session)</div><div class="ttdef"><b>Definition:</b> <a href="security__hsm_8c_source.html#l00225">security_hsm.c:225</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__import__key__in__t_html"><div class="ttname"><a href="structcms__sec__hsm__import__key__in__t.html">cms_sec_hsm_import_key_in_t</a></div><div class="ttdoc">Information on importing a private key into HSM.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00054">security.h:54</a></div></div>
<div class="ttc" id="astructcms__sec__kdf__derived__key__t_html_afd03658c6fd572ed70fae2f2cd62f37c"><div class="ttname"><a href="structcms__sec__kdf__derived__key__t.html#afd03658c6fd572ed70fae2f2cd62f37c">cms_sec_kdf_derived_key_t::key</a></div><div class="ttdeci">uint8_t key[CMS_SEC_MAX_KDF_KEY_LEN]</div><div class="ttdoc">derived key</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l01069">security_types.h:1069</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__generate__key__in__t_html"><div class="ttname"><a href="structcms__sec__hsm__generate__key__in__t.html">cms_sec_hsm_generate_key_in_t</a></div><div class="ttdoc">Information on generating a private key with HSM.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00036">security.h:36</a></div></div>
<div class="ttc" id="astructcms__sec__pubkey__t_html_a7de6da7c530f2eb20929547f35f7bd24"><div class="ttname"><a href="structcms__sec__pubkey__t.html#a7de6da7c530f2eb20929547f35f7bd24">cms_sec_pubkey_t::y</a></div><div class="ttdeci">cms_sec_scalar_t y</div><div class="ttdoc">Y coordinate - only if uncompressed.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00406">security_types.h:406</a></div></div>
<div class="ttc" id="agroup__sec__types_html_gga4f9e7f6b84624a0a443b36f4d32cc96daf93c13f97debbfab15864f25c35b43aa"><div class="ttname"><a href="group__sec__types.html#gga4f9e7f6b84624a0a443b36f4d32cc96daf93c13f97debbfab15864f25c35b43aa">CMS_SEC_PRIVATE_KEY_TYPE_PSEUDO</a></div><div class="ttdeci">@ CMS_SEC_PRIVATE_KEY_TYPE_PSEUDO</div><div class="ttdoc">Normal end entity signing key (implicit: US or csr member: EU)</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00902">security_types.h:902</a></div></div>
<div class="ttc" id="astructcms__sec__signature__t_html_ad38a6e72efb0e27f24737b80a4052e0f"><div class="ttname"><a href="structcms__sec__signature__t.html#ad38a6e72efb0e27f24737b80a4052e0f">cms_sec_signature_t::r_x</a></div><div class="ttdeci">cms_sec_scalar_t r_x</div><div class="ttdoc">X coordinate of R point.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00393">security_types.h:393</a></div></div>
<div class="ttc" id="agroup__sec__types_html_gaf9783af20eed80529f2f4455e04eccb5"><div class="ttname"><a href="group__sec__types.html#gaf9783af20eed80529f2f4455e04eccb5">cms_sec_scalar_t</a></div><div class="ttdeci">uint8_t cms_sec_scalar_t[CMS_SEC_MAX_SCALAR_LEN]</div><div class="ttdoc">Scalar value size in bytes used by cryptographic functions.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00058">security_types.h:58</a></div></div>
<div class="ttc" id="agroup__sec__types_html_gga16457bb5e640fe1101ffc314caa0934aa453e6e42e4e031634f517efcaae517ee"><div class="ttname"><a href="group__sec__types.html#gga16457bb5e640fe1101ffc314caa0934aa453e6e42e4e031634f517efcaae517ee">CMS_SEC_PUBLIC_KEY_TYPE_SIGN</a></div><div class="ttdeci">@ CMS_SEC_PUBLIC_KEY_TYPE_SIGN</div><div class="ttdoc">Used for ECDSA signing.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00915">security_types.h:915</a></div></div>
<div class="ttc" id="asecurity__hsm_8c_html_ac81a09ae711ded0c749197c40871e037"><div class="ttname"><a href="security__hsm_8c.html#ac81a09ae711ded0c749197c40871e037">do_generate_key</a></div><div class="ttdeci">static bool do_generate_key(cms_session_t *session, uint32_t key_index)</div><div class="ttdef"><b>Definition:</b> <a href="security__hsm_8c_source.html#l00070">security_hsm.c:70</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__private__multiply__add__in__t_html_a76c751b58f8e0b989077c107f618cc3d"><div class="ttname"><a href="structcms__sec__hsm__private__multiply__add__in__t.html#a76c751b58f8e0b989077c107f618cc3d">cms_sec_hsm_private_multiply_add_in_t::source_slot</a></div><div class="ttdeci">cms_sec_hsm_slot_index_t source_slot</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00105">security.h:105</a></div></div>
<div class="ttc" id="astructcms__sec__hsm__get__pubkey__in__t_html_a635a3fb34ace9f9d4dcac34ba670e9e7"><div class="ttname"><a href="structcms__sec__hsm__get__pubkey__in__t.html#a635a3fb34ace9f9d4dcac34ba670e9e7">cms_sec_hsm_get_pubkey_in_t::slot_index</a></div><div class="ttdeci">cms_sec_hsm_slot_index_t slot_index</div><div class="ttdoc">Slot index of the requested public key.</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00071">security.h:71</a></div></div>
<div class="ttc" id="agroup__api__ctrl_html_ga85a9c0702615ba256d96d9800d224af1"><div class="ttname"><a href="group__api__ctrl.html#ga85a9c0702615ba256d96d9800d224af1">cms_api_connect_easy</a></div><div class="ttdeci">static bool cms_api_connect_easy(const cms_session_t *session, const char *hostname)</div><div class="ttdoc">Connect to V2X remote API in a simplified way.</div><div class="ttdef"><b>Definition:</b> <a href="api_8h_source.html#l00084">api.h:84</a></div></div>
<div class="ttc" id="agroup__sec__types_html_ggafca00b23a6467a4927cf4c16f16b808fae2602c0b9da6c16c5b1aeaa90004979a"><div class="ttname"><a href="group__sec__types.html#ggafca00b23a6467a4927cf4c16f16b808fae2602c0b9da6c16c5b1aeaa90004979a">CMS_SEC_ECDH_KDF2</a></div><div class="ttdeci">@ CMS_SEC_ECDH_KDF2</div><div class="ttdoc">KDF2 with ha256 applied to the input ecc keys.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l01060">security_types.h:1060</a></div></div>
<div class="ttc" id="asecurity__hsm_8c_html_ad41e40ac80c3ffcafd085ba8b7312e02"><div class="ttname"><a href="security__hsm_8c.html#ad41e40ac80c3ffcafd085ba8b7312e02">do_put_slot</a></div><div class="ttdeci">static bool do_put_slot(cms_session_t *session)</div><div class="ttdef"><b>Definition:</b> <a href="security__hsm_8c_source.html#l00283">security_hsm.c:283</a></div></div>
<div class="ttc" id="astructcms__sec__signature__t_html"><div class="ttname"><a href="structcms__sec__signature__t.html">cms_sec_signature_t</a></div><div class="ttdoc">Elliptic Curve signature.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00391">security_types.h:391</a></div></div>
<div class="ttc" id="asecurity__hsm_8c_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="security__hsm_8c.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="security__hsm_8c_source.html#l00332">security_hsm.c:332</a></div></div>
<div class="ttc" id="astructcms__sec__pubkey__t_html_a1b7aa7724955e63bba5b35c10a6adef3"><div class="ttname"><a href="structcms__sec__pubkey__t.html#a1b7aa7724955e63bba5b35c10a6adef3">cms_sec_pubkey_t::type</a></div><div class="ttdeci">cms_sec_point_type_t type</div><div class="ttdoc">Point compression type.</div><div class="ttdef"><b>Definition:</b> <a href="security__types_8h_source.html#l00404">security_types.h:404</a></div></div>
<div class="ttc" id="aapi_8h_html"><div class="ttname"><a href="api_8h.html">api.h</a></div><div class="ttdoc">API Control.</div></div>
<div class="ttc" id="astructcms__sec__hsm__put__slot__in__t_html_a109767a71a3d38ed8f72420e01ebf03a"><div class="ttname"><a href="structcms__sec__hsm__put__slot__in__t.html#a109767a71a3d38ed8f72420e01ebf03a">cms_sec_hsm_put_slot_in_t::slot_index</a></div><div class="ttdeci">cms_sec_hsm_slot_index_t slot_index</div><div class="ttdef"><b>Definition:</b> <a href="security_8h_source.html#l00154">security.h:154</a></div></div>
<!-- start footer part -->
<hr class="footer"/><address class="footer"><small>
Generated by &#160;<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/>
</a> 1.8.17
</small></address>
</body>
</html>
